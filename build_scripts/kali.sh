#!/bin/sh

# This script is intended to be run on a clean Kali install
# It installs and configures a number of additional tools, and changes a few useful settings

# Run main Linux setup script
sh debian.sh

# Packages
apt install aws-cli python-virtualenv
apt purge -y network-manager
apt autoremove -y
apt autoclean

# Metasploit
systemctl start postgresql.service
msfdb init

#########
# Tools #
#########

# Dnscan
git clone https://github.com/rbsec/dnscan /opt/dnscan
ln -s /opt/dnscan/dnscan.py /usr/local/bin/dnscan.py

# Reposcanner
git clone https://github.com/dionach/reposcanner /opt/reposcanner
ln -s /opt/reposcanner/reposcanner.py /usr/local/bin/reposcanner.py

# Frogger
git clone https://github.com/nccgroup/vlan-hopping---frogger /opt/frogger
ln -s /opt/frogger/frogger.sh /usr/local/bin/frogger.sh
chmod +x /opt/frogger/frogger.sh

# ScoutSuite
git clone https://github.com/nccgroup/ScoutSuite /opt/scoutsuite
cd /opt/scoutsuite
virtualenv -p python3 venv
. venv/bin/activate
pip install -r requirements.txt
pip install azure-cli
cat <<EOT > /usr/local/bin/scout.sh
#!/bin/sh
. /opt/scoutsuite/venv/bin/activate > /dev/null 2>&1 && /opt/scoutsuite/scout.py $@
EOT
chmod +x /usr/local/bin/scout.sh
exit
