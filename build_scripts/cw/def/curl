#!/home/user/.cw/bin/cw
path /bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin:<env>
ifnarg --interactive
base default
nopipe

# HTTP Status Codes
match green+:default 200 OK
match purple:default 301 Moved Permanently
match purple:default 302 Moved Temporarily
match purple:default 302 Found
match red+:default 400 Bad Request
match red+:default 403 Forbidden
match red+:default 404 Not Found
match red+:default 405 Method Not Allowed
match red+:default 440 Login Timeout
match red+:default 501 Not Implemented

# HTTP Verbs
match green+:default GET|POST|HEAD|TRACE
match default:default OPTIONS
match default:default HTTP
match cyan+:default 1.0
match cyan+:default 1.1
match red:default TRACE

# Interesting headers
regex blue+:white set-cookie:
regex purple:purple x-clacks-overhead:
regex red:brown www-authenticate:
regex red:white date:
regex yellow:purple content-location:
regex yellow:purple location:
regex yellow:white host:
regex yellow:white via:

# Version headers
regex yellow:white microsoftofficewebserver:
regex yellow:white microsoftsharepointteamservices:
regex yellow:white server:
regex yellow:white x-aspnet-version:
regex yellow:white x-aspnetmvc-version:
regex yellow:white x-cache:
regex yellow:white x-drupal-cache:
regex yellow:white x-feserver:
regex yellow:white x-generator:
regex yellow:white x-owa-version:
regex yellow:white x-powered-by:
regex yellow:white x-servername:

# Good security headers
regex green:white access-control-allow-credentials:
regex green:white access-control-allow-origin:
regex green:white content-security-policy-report-only:
regex green:white content-security-policy:
regex green:white expect-ct
regex green:white feature-policy
regex green:white public-key-pins:
regex green:white referrer-policy
regex green:white strict-transport-security:
regex green:white x-content-type-options:
regex green:white x-frame-options:
regex green:white x-permitted-cross-domain-policies:
regex green:white x-xss-protection:

# Good strings
regex green+:white  secure
regex green+:white 'none'
regex green+:white 1; mode=block
regex green+:white httponly
regex green+:white includesubdomains
regex green+:white nosniff
regex yellow:white [a-z]+-src
regex yellow:white report-uri
regex yellow:white sameorigin

# Bad strings
regex red+:white http://
regex red:white unsafe-eval
regex red:white unsafe-inline

# Boring headers
regex grey:grey accept-ranges:
regex grey:grey accept:
regex grey:grey age:
regex grey:grey cache-control:
regex grey:grey connection:
regex grey:grey content-encoding:
regex grey:grey content-language:
regex grey:grey content-length:
regex grey:grey content-type:
regex grey:grey etag:
regex grey:grey expires:
regex grey:grey keep-alive:
regex grey:grey last-modified:
regex grey:grey p3p:
regex grey:grey pragma:
regex grey:grey transfer-encoding:
regex grey:grey user-agent:
regex grey:grey vary:
regex grey:grey x-ua-compatible:

# Boring strings
regex grey:white https://
regex grey:white 'self'

# HTTP Misc
regex blue+:yellow <title>
regex blue+:default </title>
regex blue+:white <h1>
regex blue+:default </h1>
regex cyan+:cyan+ <!--
regex cyan+:default -->
regex cyan:cyan <meta
regex default:grey <div
regex default:default </div>
regex green+:green+ <form
regex green:green <input
regex red:default deny|error
regex red:default trace: zzz

# FTP Status
match red+:default 530 Invalid userid/password
match red+:default Access denied: 530
match green:default 220
match blue+:default 331
match purple:default USER
match purple:default PASS
regex default:grey ^\*|}|\{

# SSL Errors
match red+:default does not match target host name
match red+:default certificate verify failed
match red+:default Unknown SSL protocol error

# Misc
match cyan:default >
match yellow:default <

match cyan+:cyan+ (
match cyan+:default )
regex yellow:default \-\-[a-zA-Z0-9\-]+
regex yellow:default \s\-[a-zA-Z0-9]+
